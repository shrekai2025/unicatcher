# UniCatcher éƒ¨ç½²ä¿®å¤è¯´æ˜Ž

## ðŸŽ¯ **ä¿®å¤çš„é—®é¢˜**

### **ä¸»è¦é—®é¢˜**
Dockeræž„å»ºå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯ï¼š`Could not find Prisma Schema that is required for this command`

### **é—®é¢˜åŽŸå› **
Dockerfileä¸­çš„æž„å»ºé¡ºåºé—®é¢˜ï¼š
1. å…ˆå¤åˆ¶ `package.json`
2. è¿è¡Œ `npm install` (è§¦å‘ `postinstall` ä¸­çš„ `prisma generate`)
3. ä½†æ­¤æ—¶ `prisma/` ç›®å½•è¿˜æ²¡æœ‰è¢«å¤åˆ¶åˆ°å®¹å™¨ä¸­

---

## âœ… **å·²ä¿®å¤çš„æ–‡ä»¶**

### **1. Dockerfile**
**ä¿®å¤å†…å®¹ï¼š**
- è°ƒæ•´å¤åˆ¶é¡ºåºï¼šå…ˆå¤åˆ¶ `prisma` ç›®å½•å†è¿è¡Œ `npm install`
- ç§»é™¤é‡å¤çš„ `prisma generate` å‘½ä»¤

**ä¿®æ”¹å‰ï¼š**
```dockerfile
COPY package*.json ./
RUN npm install
COPY . .
RUN npx prisma generate
```

**ä¿®æ”¹åŽï¼š**
```dockerfile
COPY package*.json ./
COPY prisma ./prisma
RUN npm install
COPY . .
```

### **2. .dockerignore**
**ä¿®å¤å†…å®¹ï¼š**
- ä¿ç•™éƒ¨ç½²ç›¸å…³çš„markdownæ–‡æ¡£
- ç¡®ä¿é‡è¦æ–‡ä»¶ä¸è¢«æ„å¤–æŽ’é™¤

**ä¿®æ”¹ï¼š**
```dockerignore
# ä¿ç•™éƒ¨ç½²ç›¸å…³çš„mdæ–‡ä»¶
!Docker*.md
!Ubuntu*.md
!*éƒ¨ç½²*.md
```

### **3. package.json**
**ä¿®å¤å†…å®¹ï¼š**
- ç¡®ä¿ç”Ÿäº§çŽ¯å¢ƒå¯åŠ¨æ—¶ä½¿ç”¨æ­£ç¡®çš„ç«¯å£

**ä¿®æ”¹ï¼š**
```json
"start": "cross-env PORT=3067 next start"
```

### **4. æ–°å¢žæ–‡ä»¶**

#### **scripts/server-deploy.sh**
- å®Œæ•´çš„æœåŠ¡å™¨éƒ¨ç½²è„šæœ¬  
- åŒ…å«çŽ¯å¢ƒæ£€æŸ¥ã€Dockerå®‰è£…ã€é¡¹ç›®æž„å»ºç­‰
- è‡ªåŠ¨å¥åº·æ£€æŸ¥å’Œé”™è¯¯å¤„ç†

---

## ðŸš€ **æœåŠ¡å™¨éƒ¨ç½²æ­¥éª¤**

### **æ–¹æ³•1ï¼šä½¿ç”¨æ–°çš„éƒ¨ç½²è„šæœ¬ï¼ˆæŽ¨èï¼‰**
```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
curl -fsSL https://raw.githubusercontent.com/shrekai2025/unicatcher/main/scripts/server-deploy.sh -o server-deploy.sh
chmod +x server-deploy.sh
./server-deploy.sh
```

### **æ–¹æ³•2ï¼šæ‰‹åŠ¨éƒ¨ç½²**
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/shrekai2025/unicatcher.git
cd unicatcher

# 2. åˆ›å»ºçŽ¯å¢ƒé…ç½®
cat > .env << 'EOF'
NODE_ENV=production
PORT=3067
AUTH_SECRET=unicatcher-secret-key-2024
NEXTAUTH_URL=http://localhost:3067
DATABASE_URL="file:./prisma/db.sqlite"
ENABLE_RESOURCE_OPTIMIZATION=true
EOF

# 3. æž„å»ºå’Œå¯åŠ¨
docker-compose build --no-cache
docker-compose up -d

# 4. æ£€æŸ¥çŠ¶æ€
curl http://localhost:3067/api/health
```

---

## ðŸ”§ **ç™»å½•çŠ¶æ€å¤„ç†**

### **å¤åˆ¶æœ¬åœ°ç™»å½•çŠ¶æ€ï¼ˆæŽ¨èï¼‰**
```bash
# åœ¨æœ¬åœ°æœºå™¨æ‰§è¡Œ
scp ./data/browser-state.json ubuntu@your-server:~/unicatcher/data/

# åœ¨æœåŠ¡å™¨éªŒè¯
cd ~/unicatcher
ls -la data/browser-state.json
```

### **å¦‚æžœæ²¡æœ‰ç™»å½•çŠ¶æ€**
å‚è€ƒä¹‹å‰æä¾›çš„æ— GUIç™»å½•æ–¹æ¡ˆï¼š
1. VNCè¿œç¨‹æ¡Œé¢ç™»å½•
2. è™šæ‹Ÿæ˜¾ç¤ºå™¨Xvfb
3. æ™ºèƒ½ç™»å½•è„šæœ¬

---

## ðŸ“Š **éªŒè¯éƒ¨ç½²æˆåŠŸ**

### **æ£€æŸ¥æœåŠ¡çŠ¶æ€**
```bash
# å®¹å™¨çŠ¶æ€
docker-compose ps

# å¥åº·æ£€æŸ¥
curl http://localhost:3067/api/health

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs unicatcher
```

### **è®¿é—®æœåŠ¡**
- **æœ¬åœ°è®¿é—®**: http://localhost:3067
- **å¤–éƒ¨è®¿é—®**: http://your-server-ip:3067
- **APIæ–‡æ¡£**: http://your-server-ip:3067/api-docs

---

## ðŸš¨ **æ•…éšœæŽ’é™¤**

### **å¦‚æžœæž„å»ºä»ç„¶å¤±è´¥**
```bash
# æ¸…ç†Dockerç¼“å­˜
docker system prune -f

# æ£€æŸ¥å…³é”®æ–‡ä»¶
ls -la prisma/schema.prisma
ls -la Dockerfile

# é‡æ–°æž„å»º
docker-compose build --no-cache --progress=plain
```

### **å¦‚æžœæœåŠ¡å¯åŠ¨å¤±è´¥**
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs -f unicatcher

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep 3067

# é‡å¯æœåŠ¡
docker-compose restart unicatcher
```

---

## ðŸ“‹ **ä¿®å¤æ€»ç»“**

âœ… **å·²è§£å†³çš„é—®é¢˜ï¼š**
- Dockeræž„å»ºæ—¶Prisma Schemaæ‰¾ä¸åˆ°
- æž„å»ºé¡ºåºå¯¼è‡´çš„ä¾èµ–é—®é¢˜
- ç”Ÿäº§çŽ¯å¢ƒç«¯å£é…ç½®
- éƒ¨ç½²è„šæœ¬çš„å®Œæ•´æ€§

âœ… **æ–°å¢žåŠŸèƒ½ï¼š**
- æ™ºèƒ½éƒ¨ç½²è„šæœ¬
- çŽ¯å¢ƒè‡ªåŠ¨æ£€æµ‹
- å¥åº·æ£€æŸ¥æœºåˆ¶
- è¯¦ç»†çš„é”™è¯¯å¤„ç†

çŽ°åœ¨é¡¹ç›®å¯ä»¥åœ¨UbuntuæœåŠ¡å™¨ä¸Šé¡ºåˆ©éƒ¨ç½²äº†ï¼ 